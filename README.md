# Проектирование высоконагруженных систем. Курсовой проект

## 1. Тема и целевая аудитория

VK Облако.

MVP включает:

    * Загрузка файлов любого формата в хранилище  
    * Скачивание файлов из хранилища  
    * Просмотр загруженных файлов через веб-интерфейс  
    * Предоставление доступа на просмотр файлов третьим лицам  

Целевая аудитория ([статистика](https://www.similarweb.com/ru/website/cloud.mail.ru/#traffic)):

    * Россия - 35 миллионов в месяц
    * Турция - 2.5 миллиона в месяц
    * Украина - 1.5 миллиона в месяц
    * Беларусь - 1.5 миллиона в месяц
    * Казахстан - 1.2 миллиона в месяц
    * Другие страны - 5.3 миллионов в месяц

## 2. Расчет нагрузки

### Продуктовые метрики

Согласно [статистике](https://www.similarweb.com/ru/website/cloud.mail.ru/#traffic), Облако в месяц посещают 47 миллионов пользователей.  
В среднем ежедневно около 1.5 миллиона посещений.  

Размер хранилища, доступный при бесплатном использовании, равен 8 Гб.  

Пусть около 50% посещений происходит с запросом авторизации, тогда ежедневно выполняется 750 тысяч запросов на авторизацию.  
Первая страница Облака представляет собой список файл, соответственно при посещении пользователь хотя бы раз делает запрос на список файлов. Предположим, что в день запросов на просмотр списка файлов около 7.5 миллионов.  
Самая часто используемая функция Облака - это просмотр файлов. Чаще всего пользователь за одно посещение просматривает по несколько файлов. Предположим, что таких запросов порядка 300 миллионов.  
Загрузка файлов происходят реже. Предположим, что таких запросов будет 85 миллионов.  
Делятся файлами пользователи довольно редко. Предположим, что таких запросов 2 миллиона.  

**Среднее количество действий пользователей**
Тип запроса             | Среднее количество (млн/день)
----------------------- | -----------------------------
Авторизация             | 0.75
Просмотр списка файлов  | 7.5
Просмотр файлов         | 300
Загрузка файлов         | 85
Шаринг файла            | 2

### Технические метрики

Размер бесплатного хранилища пользователя равен 8 Гб. Тогда размер хранилища равен 47 * 10^6 * 8 = 367 187 Тб. Учтем также платных пользователей, умножив размер на 2.  
Тогда общий объём хранилища будет равен ~ 750 000 Тб.

Обычно пользователи хранят в облаке фотографии или текстовые документы. Будем считать, что их средний размер 4 Мб.  
Считаем, что в пике средняя нагрузка увеличина в 2 раза.

**Входящий трафик**
Тип запроса             | Объём 1 запроса (Кб) | Суточный объём (Гб/сутки) | Пиковое потребление в течении суток (Гбит/с)
----------------------- | -------------------- | ------------------------- | --------------------------------------------
Авторизация             | 1                    | 0.75                      | 0.0001
Загрузка файлов         | 4096                 | 332 031                   | 70
Шаринг файла            | 1                    | 1.9                       | 0.0004


**Исходящий трафик**
Тип запроса             | Объём 1 запроса (Кб) | Суточный объём (Гб/сутки) | Пиковое потребление в течении суток (Гбит/с)
----------------------- | -------------------- | ------------------------- | --------------------------------------------
Просмотр списка файлов  | 512                  | 3 662                     | 1
Просмотр файлов         | 4096                 | 1 171 875                 | 220


**Количество RPS по типам запросов**
Тип запроса             | RPS
----------------------- | -----
Авторизация             | 16
Просмотр списка файлов  | 200
Просмотр файлов         | 7 000
Загрузка файлов         | 2 000

